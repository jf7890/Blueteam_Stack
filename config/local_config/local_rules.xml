<group name="custom,web,fim,modsecurity,">

  <rule id="100000" level="2">
    <decoded_as>json</decoded_as>
    <field name="producer.modsecurity">.</field>
    <description>ModSecurity log detected</description>
    <options>no_full_log</options>
  </rule>

  <rule id="100010" level="10">
    <if_sid>100000</if_sid>
    <field name="messages.message" type="pcre2">(?i)SQL Injection</field>
    <description>SQL Injection attempt detected</description>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

  <rule id="100021" level="12">
    <if_sid>100010</if_sid>
    <field name="transaction.response.http_code">403</field>
    <description>SQL Injection BLOCKED by WAF</description>
  </rule>

  <rule id="100022" level="13">
    <if_sid>100010</if_sid>
    <field name="transaction.response.http_code">200</field>
    <description>SQL Injection successful (HTTP 200)</description>
  </rule>

  <rule id="100300" level="10">
    <if_sid>100000</if_sid>
    <field name="messages.details.ruleId" type="pcre2">^942</field>
    <description>SQL Injection detected by ModSecurity CRS (ruleId 942xxx)</description>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

  <rule id="100100" level="8">
    <if_group>syscheck</if_group>
    <field name="syscheck.event">added</field>
    <description>File added to system</description>
  </rule>

  <rule id="100101" level="10">
    <if_sid>100100</if_sid>
    <field name="syscheck.path">/dvwa_upload/</field>
    <description>File uploaded to web directory</description>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>

  <rule id="100102" level="13">
    <if_sid>100101</if_sid>
    <field name="syscheck.path" type="pcre2">\.php$</field>
    <description>Possible Webshell (.php) uploaded to web directory</description>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>

</group>